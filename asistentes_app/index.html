<!DOCTYPE html><html><head><meta charset="UTF-8"><title>jQuery Mobile Web App</title><meta name="viewport" content="initial-scale=1.0,maximum-scale=1.0,height=device-height,width=device-width,user-scalable = no"><link href="jquery-mobile/jquery.mobile-1.3.1.min.css" rel="stylesheet" type="text/css"/><script src="jquery-mobile/jquery-2.0.3.js" type="text/javascript"></script><script src="jquery-mobile/jquery.mobile-1.3.1.min.js" type="text/javascript"></script></head><body><div data-role="page" id="page">  <div data-role="header">    <h1>Asistentes</h1>    <a href="#page2" data-icon="plus" data-iconpos="notext" class="ui-btn-right">Agregar</a> </div>  <div data-role="content">    <ul data-role="listview" id="laLista" data-filter="true" data-filter-placeholder="buscar asistente">      <div style="text-align:center; margin:20px;">No hay asistentes registrados</div>    </ul>  </div>  <div data-role="footer">    <h4>Page Footer</h4>  </div></div><div data-role="page" id="page2" data-add-back-btn="true" data-back-btn-text="volver">  <div data-role="header">    <h1>Agregar</h1>  </div>  <div data-role="content">    <form id="formAgregar">      <input type="text" name="nombre" id="nombre" value="" placeholder="nombre" autofocus>      <input type="email" name="email" id="email" value="" placeholder="email">      <input type="submit" value="Agregar" data-icon="plus">    </form>  </div>  <div data-role="footer">    <h4>Page Footer</h4>  </div></div><div data-role="page" id="page3" data-add-back-btn="true" data-back-btn-text="volver">  <div data-role="header">    <h1>Modificar</h1>  </div>  <div data-role="content">    <form id="formModificar">      <input type="text" name="mnombre" id="mnombre" value="" placeholder="nombre" autofocus>      <input type="email" name="memail" id="memail" value="" placeholder="email">      <input type="hidden" name="mid" id="mid" value="" >      <div data-role="controlgroup" data-type="horizontal" style="text-align:center">        <input type="button" id="eliminar" value="eliminar" data-icon="delete">        <input type="submit" value="Modificar" data-icon="refresh" data-iconpos="right">      </div>    </form>  </div>  <div data-role="footer">    <h4>Page Footer</h4>  </div></div><div data-role="page" id="page4">  <div data-role="header">    <h1>Page Four</h1>  </div>  <div data-role="content"> Content </div>  <div data-role="footer">    <h4>Page Footer</h4>  </div></div><script type="text/javascript">jQuery(document).ready(function(e) {	//crear la BD	function crearBD(){		var nombre='evento',version='1.0',descripcion='BD de los eventos y asistentes',tamano=1024 * 1024 * 2;		db=openDatabase(nombre,version,descripcion,tamano);		crearTabla();	}	//crear la tabla	function exito(tx, data){		console.log(data)	}	function falla(tx,data){		console.log(data);		return false;	}	function crearTabla(){		db.transaction(function(tx){			tx.executeSql("CREATE TABLE IF NOT EXISTS asistentes (id INTEGER PRIMARY KEY AUTOINCREMENT, nombre TEXT, email TEXT, fecha DATE)",[],consultaDato,falla);			//tx.executeSql("INSERT INTO asistentes (nombre, email, fecha) VALUES (?,?,datetime('now','localtime'))",["luis felipe","luisfel@luisfel.cl"],exito,falla);		});	}	//consultar	function consultaDato(){		db.transaction(function(tx){			tx.executeSql("SELECT * FROM asistentes WHERE 1 ORDER BY nombre",[],function(tx,data){				if(data.rows.length){					var lista="";					for(i=0;i<data.rows.length;i++){						var row=data.rows.item(i);						lista+='<li><a href="#page3" id="'+row.id+'" class="este">'+row.nombre+'</a></li>';					}					$("#laLista").html(lista).listview("refresh");;				}			},falla);		});	}	$(document).on("click",".este",function(e){		var elid=this.id;		db.transaction(function(tx){			tx.executeSql("SELECT * FROM asistentes  WHERE 1 AND id =?",[elid],function(tx,data){				var row=data.rows.item(0);				$("#mnombre").val(row.nombre);				$("#memail").val(row.email);				$("#mid").val(row.id);			},falla);		});	});	//agregar	$("#formAgregar").submit(function(e){		var nombre=$("#nombre").val(),email=$("#email").val();		db.transaction(function(tx){			tx.executeSql("INSERT INTO asistentes (nombre, email, fecha) VALUES (?,?,datetime('now','localtime'))",[nombre,email],function(tx,data){				$("#nombre").val('')				$("#email").val('');				consultaDato();				window.history.back();			},falla);		});		return false;	});	//modificar	$("#formModificar").submit(function(e){		var nombre=$("#mnombre").val(),email=$("#memail").val(), elid=$("#mid").val();		db.transaction(function(tx){			tx.executeSql("UPDATE asistentes SET nombre=?, email=?, fecha=datetime('now','localtime') WHERE id=?",[nombre,email,elid],function(tx,data){				$("#mnombre").val('')				$("#memail").val('');				consultaDato();				window.history.back();			},falla);		});		return false;	});	//eliminar	$("#eliminar").click(function(e){		if(confirm('est√° seguro?')){			var elid=$("#mid").val();			db.transaction(function(tx){				tx.executeSql("DELETE FROM asistentes WHERE id=?",[elid],function(tx,data){					$("#mnombre").val('')					$("#memail").val('');					consultaDato();					window.history.back();				},falla);			});		}	});	crearBD();});</script></body></html>